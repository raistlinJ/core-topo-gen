{% extends "layout.html" %}

{% block title %}README â€” Vuln-Catalog{% endblock %}

{% block header_icon %}<i class="bi bi-book fs-4"></i>{% endblock %}
{% block header_title %}Vuln-Catalog README{% endblock %}

{% block extra_head %}
<style>
  .readme-wrap { max-width: 1100px; }
  .markdown-body {
    font-size: 0.95rem;
    line-height: 1.6;
    color: #24292f;
  }
  .markdown-body a { color: #0969da; text-decoration: none; }
  .markdown-body a:hover { text-decoration: underline; }
  .markdown-body p { margin: 0.75rem 0; }
  .markdown-body hr { margin: 1.25rem 0; border-top: 1px solid rgba(0,0,0,0.12); }
  .markdown-body h1, .markdown-body h2, .markdown-body h3,
  .markdown-body h4, .markdown-body h5, .markdown-body h6 {
    font-weight: 600;
    line-height: 1.25;
    margin-top: 1.25rem;
    margin-bottom: 0.75rem;
  }
  .markdown-body h1 { font-size: 1.6rem; border-bottom: 1px solid rgba(0,0,0,0.12); padding-bottom: 0.3rem; }
  .markdown-body h2 { font-size: 1.35rem; border-bottom: 1px solid rgba(0,0,0,0.10); padding-bottom: 0.25rem; }
  .markdown-body h3 { font-size: 1.15rem; }
  .markdown-body ul, .markdown-body ol { margin: 0.6rem 0 0.9rem 1.25rem; }
  .markdown-body li { margin: 0.15rem 0; }

  .markdown-body code {
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: 0.9em;
    background: rgba(175,184,193,0.2);
    padding: 0.15rem 0.3rem;
    border-radius: 0.35rem;
  }
  .markdown-body pre {
    padding: 0.85rem;
    border: 1px solid rgba(0,0,0,0.08);
    border-radius: 0.6rem;
    background: #0b1020;
    color: #e5e7eb;
    overflow: auto;
    margin: 0.9rem 0;
  }
  .markdown-body pre code {
    background: transparent;
    padding: 0;
    border-radius: 0;
    color: inherit;
    font-size: 0.92em;
  }

  .markdown-body table { width: 100%; margin: 0.9rem 0; border-collapse: collapse; }
  .markdown-body table th, .markdown-body table td {
    border: 1px solid rgba(0,0,0,0.1);
    padding: 0.4rem 0.55rem;
    vertical-align: top;
  }
  .markdown-body table thead th { background: rgba(175,184,193,0.16); font-weight: 600; }

  .markdown-body blockquote {
    border-left: 4px solid rgba(9,105,218,0.35);
    padding: 0.1rem 0 0.1rem 0.85rem;
    margin: 0.9rem 0;
    color: rgba(0,0,0,0.72);
  }

  .markdown-body img {
    max-width: 100%;
    height: auto;
  }

  /* Plain-text fallback */
  .readme-plain {
    white-space: pre-wrap;
    word-break: break-word;
    background: #0b1020;
    color: #e5e7eb;
    border-radius: 0.6rem;
    border: 1px solid rgba(0,0,0,0.08);
    padding: 0.85rem;
    margin: 0;
  }
</style>
{% endblock %}

{% block content %}
<div class="readme-wrap">
  <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
    <div>
      <div class="text-muted small">{{ readme_rel }}</div>
      <h4 class="mb-0">{{ readme_title }}</h4>
    </div>
    <div class="d-flex align-items-center gap-2">
      <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('vuln_catalog_packs_browse', catalog_id=catalog_id) }}">Back to Browse</a>
      <a class="btn btn-sm btn-outline-primary" href="{{ url_for('vuln_catalog_packs_view', catalog_id=catalog_id, subpath=readme_rel) }}" target="_blank" rel="noopener">Open Raw</a>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body readme-content">
      {% if render_warning %}
        <div class="alert alert-warning py-2 mb-3" role="alert">
          {{ render_warning }}
        </div>
      {% endif %}
      {% if rendered_html %}
        <div class="markdown-body">{{ rendered_html|safe }}</div>
      {% else %}
        <pre class="readme-plain">{{ plain_text }}</pre>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
